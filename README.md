# ðŸ§  Claude Usage Menubar

A macOS menubar app that displays your Claude.ai usage statistics.

![macOS](https://img.shields.io/badge/macOS-13.0+-blue)
![Swift](https://img.shields.io/badge/Swift-5.9-orange)
![License](https://img.shields.io/badge/license-MIT-green)

<p align="center">
  <img src="screenshot.png" alt="Claude Usage Screenshot" width="400">
</p>

## Disclaimer

> **This is an unofficial tool, created as a learning project for "vibe coding" with Claude Code.**
> **100% of the code was generated by Claude Code â€” no manual coding involved.**
>
> - Not affiliated with Anthropic
> - Use at your own risk
> - No warranty provided

## Features

- Auto-connects via Claude Code CLI (zero-interaction login)
- 5-hour and 7-day usage display in menubar
- Color-coded status indicator (green/yellow/red)
- Configurable auto-refresh (1, 3, 5, 10 min)
- Extra Usage section with spending progress and monthly limit
- Reset sound notification when quota recovers

## How It Works

1. Requires [Claude Code](https://docs.anthropic.com/en/docs/claude-code) installed and logged in
2. App auto-detects Claude Code's OAuth credentials from macOS Keychain
3. Fetches usage via `api.anthropic.com` â€” no login required

> Only reads your own usage data. No conversations or personal info accessed.

## Recent Changes

### OAuth Migration

Migrated from cookie-based authentication (`claude.ai` WebView login) to OAuth via Claude Code CLI:

- **Zero-interaction login** â€” reads OAuth credentials directly from Claude Code's Keychain entry
- **Token refresh** â€” automatic token refresh via `POST /v1/oauth/token`
- **Removed** â€” WebView login flow, cookie storage, Keychain write access, Disconnect button

### Extra Usage

- Spending progress display with amount, percentage, and progress bar
- Read-only enabled/disabled status indicator
- Monthly reset date shown in section header
- Graceful fallback when detailed API endpoints are unavailable
- Clean disabled state (hides spending data and reset time when extra usage is off)
- "Manage in Browser" link to claude.ai settings

## Build & Run

```bash
git clone git@github.com:P233/claude-usage.app.git
cd claude-usage
git checkout oauth
chmod +x build.sh
./build.sh
```

> **Intel Mac:** Edit `build.sh` line 66, change `arm64` to `x86_64`

## Troubleshooting

| Issue                        | Solution                                           |
| ---------------------------- | -------------------------------------------------- |
| Not detecting Claude Code    | Make sure Claude Code is installed and logged in (`claude auth status`) |
| Keychain prompt every launch | Click "Always Allow"                               |
| App blocked by Gatekeeper    | System Settings â†’ Privacy & Security â†’ Open Anyway |
| Session expired              | Restart Claude Code to refresh credentials          |

## License

MIT
